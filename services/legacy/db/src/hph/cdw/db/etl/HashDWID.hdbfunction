FUNCTION "hc.hph.cdw.db.etl::HashDWID" ( Source NVARCHAR(5), BusinessKey NVARCHAR( 1024 ) ) 
    RETURNS DWID VARBINARY( 32 )
    LANGUAGE SQLSCRIPT
    SQL SECURITY INVOKER AS
BEGIN
    IF LENGTH( TO_BINARY( RPAD( :Source, 5, ' ' ) || :BusinessKey ) ) < 32 THEN
        DWID := TO_BINARY( RPAD( :Source, 5, ' ' ) || :BusinessKey );
    ELSE        
        DWID := HASH_SHA256( TO_BINARY( RPAD( :Source, 5, ' ' ) || :BusinessKey ) );
    END IF;
END;