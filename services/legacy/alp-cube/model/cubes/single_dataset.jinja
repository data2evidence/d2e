cubes:
  {# Load a single dataset for an already defined schema by importing the load_single_dataset function from globals.py #}
  {%- for cube in load_single_dataset()["cubes"] %}
 
  - name: {{ cube.name }}
    sql_table: cdmdefault.{{ cube.name }}
    data_source: default
    refresh_key:
      every: 1 hour
 
  {%- if cube.measures is not none and cube.measures|length > 0 %}
    measures:
      {%- for measure in cube.measures %}
      - name: {{ measure.name }}
        type: {{ measure.type }}
      {%- if measure.sql %}
        sql: {{ measure.sql }}
      {%- endif %}
      {%- endfor %}
  {%- endif %}

  {%- if cube.dimensions is not none and cube.dimensions|length > 0 %}
    dimensions:
      {%- for dimension in cube.dimensions %}
      - name: {{ dimension.name }}
        type: {{ dimension.type }}
      {%- if dimension.sql %}
        sql: {{ dimension.sql|upper }}
      {%- endif %}
      {%- endfor %}
  {%- endif %}


  {%- endfor -%}